{% load i18n widget_tweaks %}
{% with WIDGET_ERROR_CLASS='is-invalid' %}
<form hx-post="{{ request.path }}" id="details-form" class="needs-validation" novalidate> 
  <div class="tab-pane fade" id="general-tab-pane" role="tabpanel" aria-labelledby="general-tab" tabindex="0">
    <fieldset class="row g-3 mb-4">
      <legend>{% translate 'Identification' %}</legend>
      <div class="col-4">
        <label for="{{ form.account_num.id_for_label }}" class="form-label">{{ form.account_num.label_tag }}</label>
        {% render_field form.account_num class="form-control" readonly="readonly" %}
        <div class="invalid-feedback">{{ form.account_num.errors|first }}</div>
      </div>
      <div class="col-md-8">
        <label for="{{ form.name.id_for_label }}" class="form-label">{{ form.name.label_tag }}</label>
        {% render_field form.name class="form-control" autocomplete="off" %}
        <div class="invalid-feedback">{{ form.name.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.short_name.id_for_label }}" class="form-label">{{ form.short_name.label_tag }}</label>
        {% render_field form.short_name class="form-control" autocomplete="off" %}
        <div class="invalid-feedback">{{ form.short_name.errors|first }}</div>
      </div>
      <div class="col-md-6">
        <label for="{{ form.blocked.id_for_label }}" class="form-label">{{ form.blocked.label_tag }}</label>
        <div class="mb-3 form-check form-switch">
        <label for="{{ form.blocked.id_for_label }}" class="form-check-label">{{ form.blocked.help_text }}</label>
        {% render_field form.blocked class="form-check-input form-control" role="switch" %}
        </div>
        <div class="invalid-feedback">{{ form.blocked.errors|first }}</div>
      </div>
    </fieldset>
    <fieldset class="row g-3 mb-4">
      <legend>{% translate 'Vender' %}</legend>
      <div class="col-md-4">
        <label for="{{ form.vend_group.id_for_label }}" class="form-label">{{ form.vend_group.label_tag }}</label>
        {% render_field form.vend_group class="form-control" %}
        <div class="invalid-feedback">{{ form.vend_group.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.currency.id_for_label }}" class="form-label">{{ form.currency.label_tag }}</label>
        {% render_field form.currency class="form-control" %}
        <div class="invalid-feedback">{{ form.currency.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.language.id_for_label }}" class="form-label">{{ form.language.label_tag }}</label>
        {% render_field form.language class="form-control" %}
        <div class="invalid-feedback">{{ form.language.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.countryregion.id_for_label }}" class="form-label">{{ form.countryregion.label_tag }}</label>
        {% render_field form.countryregion class="form-control" %}
        <div class="invalid-feedback">{{ form.countryregion.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.main_contact.id_for_label }}" class="form-label">{{ form.main_contact.label_tag }}</label>
        {% render_field form.main_contact class="form-control select2" %}
        <div class="invalid-feedback">{{ form.main_contact.errors|first }}</div>
      </div>
      <div class="col-md-4">
        <label for="{{ form.url.id_for_label }}" class="form-label">{{ form.url.label_tag }}</label>
        {% render_field form.url class="form-control" %}
        <div class="invalid-feedback">{{ form.url.errors|first }}</div>
      </div>
      <div class="col-md-12">
        <label for="{{ form.notes.id_for_label }}" class="form-label">{{ form.notes.label_tag }}</label>
        {% render_field form.notes class="form-control" rows="3" %}
        <div class="invalid-feedback">{{ form.notes.errors|first }}</div>
      </div>
      <div class="col-md-3">
        <label for="id_created_by" class="form-label">{% translate "Created by" %}</label>
        <input type="text" readonly class="form-control-plaintext" value="{{ vendtable.created_by }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">{% translate "Created date time" %}:</label>
        <input type="text" readonly class="form-control-plaintext" value="{{ vendtable.created_dt }}">
      </div>
      <div class="col-md-3">
        <label for="id_modified_by" class="form-label">{% translate "Last modified by" %}</label>
        <input type="text" readonly class="form-control-plaintext" value="{{ vendtable.modified_by }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">{% translate "Last modified date time" %}:</label>
        <input type="text" readonly class="form-control-plaintext" value="{{ vendtable.lastmodified_dt }}">
      </div>
    </fieldset>
  </div>
  <div class="tab-pane fade" id="setup-tab-pane" role="tabpanel" aria-labelledby="setup-tab" tabindex="0">
    <div class="row g-3">
      <fieldset class="col">
        <legend>{% translate 'Invoice' %}</legend>
        <div class="mb-3">
          <label for="{{ form.invoice_account.id_for_label }}" class="form-label">{{ form.invoice_account.label_tag }}</label>
          {% render_field form.invoice_account class="form-control select2" %}
          <div class="invalid-feedback">{{ form.invoice_account.errors|first }}</div>
        </div>
      </fieldset>
      <fieldset class="col">
        <legend>{% translate 'Delivery' %}</legend>
        <div class="mb-3">
          <label for="{{ form.dlv_term.id_for_label }}" class="form-label">{{ form.dlv_term.label_tag }}</label>
          {% render_field form.dlv_term class="form-control" %}
          <div class="invalid-feedback">{{ form.dlv_term.errors|first }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.dlv_mode.id_for_label }}" class="form-label">{{ form.dlv_mode.label_tag }}</label>
          {% render_field form.dlv_mode class="form-control" %}
          <div class="invalid-feedback">{{ form.dlv_mode.errors|first }}</div>
          <div class="form-text">{{ form.dlv_mode.help_text }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.dlv_destination.id_for_label }}" class="form-label">{{ form.dlv_destination.label_tag }}</label>
          {% render_field form.dlv_destination class="form-control" %}
          <div class="invalid-feedback">{{ form.dlv_destination.errors|first }}</div>
          <div class="form-text">{{ form.dlv_destination.help_text }}</div>
        </div>
      </fieldset>
      <fieldset class="col">
        <legend>{% translate 'Payment' %}</legend>
        <div class="mb-3">
          <label for="{{ form.paym_term.id_for_label }}" class="form-label">{{ form.paym_term.label_tag }}</label>
          {% render_field form.paym_term class="form-control" %}
          <div class="invalid-feedback">{{ form.paym_term.errors|first }}</div>
          <div class="form-text">{{ form.paym_term.help_text }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.tax_group.id_for_label }}" class="form-label">{{ form.tax_group.label_tag }}</label>
          {% render_field form.tax_group class="form-control" %}
          <div class="invalid-feedback">{{ form.tax_group.errors|first }}</div>
          <div class="form-text">{{ form.tax_group.help_text }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.incl_tax.id_for_label }}" class="form-label">{{ form.incl_tax.label_tag }}</label>
          <div class="form-check form-switch">
          <label for="{{ form.incl_tax.id_for_label }}" class="form-check-label">{{ form.incl_tax.help_text }}</label>
          {% render_field form.incl_tax class="form-check-input form-control" role="switch" %}
          </div>
          <div class="invalid-feedback">{{ form.is_active.errors|first }}</div>
        </div>
      </fieldset>
    </div>
  </div>
  <div class="tab-pane fade" id="address-tab-pane" role="tabpanel" aria-labelledby="address-tab" tabindex="0">
    {% if perms.vend.add_vendaddress %}
    <div class="d-flex justify-content-between">
      <div class="p-2">{{ vendtable.account_num }} | {{ vendtable.name }}</div>
      <a hx-get="{% url 'vend:vendaddress-create' vendtable.id %}" class="btn btn-primary btn-sm mb-2" hx-target="#comaddressform" hx-swap="beforebegin"
      data-toggle="tooltip" data-bs-placement="top" data-bs-title={% translate 'New' %}>
        <i class="fa-solid fa-plus"></i>&nbsp;&nbsp;{% translate 'New' %}
      </a>
    </div>
    {% endif %}
    {% if perms.vend.view_vendaddress %}
    <div id="comaddressform">
    {% for vendaddress in vendtable.vendaddress_set.all %}
      {% include "vend/vendaddress_detail.html" %}
    {% endfor %}
    {% endif %}
    </div>
  </div>
  <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
    {% if perms.vend.add_vendcontact %}
    <div class="d-flex justify-content-between">
      <div class="p-2">{{ vendtable.account_num }} | {{ vendtable.name }}</div>
      <a hx-get="{% url 'vend:vendcontact-create' vendtable.id %}" class="btn btn-primary btn-sm mb-2" hx-target="#contactform" hx-swap="beforebegin"
      data-toggle="tooltip" data-bs-placement="top" data-bs-title={% translate 'New' %}>
        <i class="fa-solid fa-plus"></i>&nbsp;&nbsp;{% translate 'New' %}
      </a>
    </div>
    {% endif %}
    {% if perms.vend.view_vendcontact %}
    <div id="contactform">
    {% for vendcontact in vendtable.vendcontact_set.all %}
      {% include "vend/vendcontact_detail.html" %}
    {% endfor %}
    {% endif %}
    </div>
  </div>
  <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2 d-none">
      <button type="submit" class="btn btn-primary d-none" id="btnsubmit">{% translate 'Submit' %}</button>
  </div>
</form>
{% endwith %}
<script>
// show form after page refreshed
$(function() {
  var activeTab = $(".nav-link.active").attr('data-bs-target');
  //alert(activeTab);
  $(".tab-pane").not(activeTab).addClass('d-none')
  $(activeTab).addClass("active show");

  $( '.select2' ).select2({
    theme: "bootstrap-5",
    width: "100%",
  });
})

</script>